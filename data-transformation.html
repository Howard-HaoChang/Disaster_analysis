<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Data transformation | 03-cleaning.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Data transformation | 03-cleaning.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Data transformation | 03-cleaning.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SHORT TITLE HERE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#data-transformation"><i class="fa fa-check"></i><b>1</b> Data transformation</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#disaster-data"><i class="fa fa-check"></i><b>1.1</b> Disaster Data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path=""><a href="#checking-the-country-name"><i class="fa fa-check"></i><b>1.1.1</b> checking the country name</a></li>
<li class="chapter" data-level="1.1.2" data-path=""><a href="#manual-adjustments"><i class="fa fa-check"></i><b>1.1.2</b> Manual Adjustments</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#covid-data"><i class="fa fa-check"></i><b>1.2</b> Covid Data</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#gdp"><i class="fa fa-check"></i><b>1.3</b> GDP</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="data-transformation" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Data transformation<a href="#data-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="disaster-data" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Disaster Data<a href="#disaster-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading disaster data and map message data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">&quot;data/emdat_public_2022_04_30_full.xlsx&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>latitude.longtitude.data <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">&quot;world&quot;</span>)</span></code></pre></div>
<p>We want to add location information to disaster data for graphical visualization. However, due to the large time span of our data, some countries have experienced splitting or merging in this 100-year period, so in order to ensure that our data can be merged with the data of geographic information through the country name, we need to clean our countries’ names first before doing the merge.</p>
<div id="checking-the-country-name" class="section level3 hasAnchor" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> checking the country name<a href="#checking-the-country-name" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply the countryname function to standardize the countryname of each dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">countryname</span>(<span class="fu">unique</span>(raw_data<span class="sc">$</span>Country))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">countryname</span>(<span class="fu">unique</span>(latitude.longtitude.data<span class="sc">$</span>region))</span></code></pre></div>
<p><code>Warning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest,  :</code>
<code>Some values were not matched unambiguously: Azores Islands, Canary Is, Serbia Montenegro, Yemen P Dem Rep</code></p>
<p><code>Warning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest,  :</code>
<code>Some values were not matched unambiguously: Ascension Island, Azores, Barbuda, Canary Islands, Chagos Archipelago, Grenadines, Heard Island, Madeira Islands, Micronesia, Saba, Saint Martin, Siachen Glacier, Sint Eustatius, Virgin Islands</code></p>
<p>There are several reasons for mismatching:</p>
<ul>
<li>First situation, the countries are too small to be included in the package.(e.g. “Tuvalu”, “Micronesia (Federated States of)”)</li>
<li>Second situation, the countries are no longer exist since our data contains data from 1900. (e.g. “Serbia Montenegro”, “Yemen P Dem Rep”)
<ul>
<li>“Yemen P Dem Rep” merged with “Yemen Arab Rep” in 1990 and is called “Yemen” now.</li>
</ul></li>
<li>Third situation, this does not show up here, but we need to consider the situation that some of the countries disintegrated during the past 122 years. (e.g. “Czechoslovakia”, “Yugoslavia”) In this situation, we may need to change the data of one country into several.
<ul>
<li>“Serbia Montenegro” split into two countries called “Serbia” and “Montengro” in 2006.</li>
<li>“Yugoslavia” had split into six countries,“Slovenia”,“Croatia”, “Serbia”, “Montengro”, “Bosnia and Herzegovina” and “Macedonia”.</li>
<li>“Czechoslovakia” had split into two countries, “Czech Republic” and “Slovakia”, in 1993.</li>
</ul></li>
</ul>
</div>
<div id="manual-adjustments" class="section level3 hasAnchor" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Manual Adjustments<a href="#manual-adjustments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Based on the above three situation, we did some manual adjustment(splitting) on our data, and reread in the data.<br />
Our splited countries are：“Czechoslovakia”， “Yugoslavia”，and “Serbia Montenegro”.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data after splitting certain countries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data_temp <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">&quot;data/disaster data.xlsx&quot;</span>) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># some manual adjustments</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># delete &quot;Micronesia (Federated States of)&quot; and &quot;Tuvalu&quot;, which does not included in the existing data, hence do not have latitude and longitude information.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data_remove <span class="ot">&lt;-</span> data_temp[<span class="sc">-</span><span class="fu">which</span>(data_temp<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Micronesia (Federated States of)&quot;</span>,<span class="st">&quot;Tuvalu&quot;</span>)),]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># manual match some small contries: Azores Islands - Azores; Canary Is - Canary Islands</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Azores Islands&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Azores&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Canary Is&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Canary Islands&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># merge &quot;Yemen P Dem Rep&quot; and &quot;Yemen Arab Rep&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Yemen P Dem Rep&quot;</span>,<span class="st">&quot;Yemen Arab Rep&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Yemen&quot;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Virgin Islands are one area in existing data, so merge together: Virgin Island (British) &amp; Virgin Island (U.S.) - Virgin Islands</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Virgin Island (British)&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Virgin Islands&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Virgin Island (U.S.)&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Virgin Islands&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;Hong Kong&quot; and &quot;Macao&quot; belong to China now</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Hong Kong&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;China&quot;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Macao&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;China&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;Netherlands Antilles&quot; belongs to &quot;Caribbean Netherlands&quot;, but does not have independent geographic information, so including it in &quot;Netherlands&quot;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Netherlands Antilles&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Netherlands&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># same situation, including &quot;Saint Martin (French part)&quot; in &quot;Saint Martin&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Saint Martin (French Part)&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Saint Martin&quot;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;Tokelau&quot; is belong to &quot;New Zealand&quot;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>data_remove<span class="sc">$</span>Country[data_remove<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">&quot;Tokelau&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;New Zealand&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># adding a column called &quot;countryname&quot; to be the standard country names, and when mismatch then the country must be one of our adjusted countries, so just keep it as it is.</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>disaster_match <span class="ot">&lt;-</span> data_remove <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country.name =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="fu">countryname</span>(data_remove<span class="sc">$</span>Country)),data_remove<span class="sc">$</span>Country,<span class="fu">countryname</span>(data_remove<span class="sc">$</span>Country)))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#The data frame has a total of 50 variables, but we won&#39;t use all of them, so we need to tidy the data.</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>disaster <span class="ot">&lt;-</span> disaster_match <span class="sc">%&gt;%</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;Year&quot;</span>,<span class="st">&quot;Disaster Group&quot;</span>,<span class="st">&quot;Disaster Subgroup&quot;</span>,<span class="st">&quot;Disaster Type&quot;</span>,<span class="st">&quot;Disaster Subtype&quot;</span>,<span class="st">&quot;Country&quot;</span>,<span class="st">&quot;ISO&quot;</span>,<span class="st">&quot;Region&quot;</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Continent&quot;</span>,<span class="st">&quot;Total Deaths&quot;</span>,<span class="st">&quot;Total Damages (&#39;000 US$)&quot;</span>,<span class="st">&quot;Total Damages, Adjusted (&#39;000 US$)&quot;</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(disaster) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Year&quot;</span>,<span class="st">&quot;Disaster Group&quot;</span>,<span class="st">&quot;Disaster Subgroup&quot;</span>,<span class="st">&quot;Disaster Type&quot;</span>,<span class="st">&quot;Disaster Subtype&quot;</span>,<span class="st">&quot;Country&quot;</span>,<span class="st">&quot;ISO&quot;</span>,<span class="st">&quot;Region&quot;</span>,<span class="st">&quot;Continent&quot;</span>,<span class="st">&quot;Total Deaths&quot;</span>,<span class="st">&quot;Total Damages&quot;</span>,<span class="st">&quot;Total Damages Adjusted&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="covid-data" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Covid Data<a href="#covid-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The number of deaths in this data is refreshed daily in the last column and is cumulative so we only need to keep the last column for the number of deaths in each country. Because some countries count the number of deaths according to different cities, we need to add up the number of deaths in different cities in each country and combine them into the total number of deaths in a country.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading covid data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_covid_raw <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv&#39;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>covid_df <span class="ot">=</span> df_covid_raw <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">ncol</span>(df_covid_raw)) </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>covid_df <span class="ot">=</span> <span class="fu">cbind</span>(<span class="st">&quot;Country.Region&quot;</span> <span class="ot">=</span> df_covid_raw<span class="sc">$</span>Country.Region, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Total.Death&quot;</span> <span class="ot">=</span> <span class="fu">rowSums</span>(covid_df)) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>covid_df <span class="ot">=</span> covid_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="st">&quot;Total.Death&quot;</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(Total.Death)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country.Region) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">&quot;Total.Death&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(Total.Death, <span class="at">na.rm =</span> T))</span></code></pre></div>
<p>In order to compare the data together, we also need to unify the country names of the data according to the corrected disaster data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply the countryname function to standardize the countryname of dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">countryname</span>(<span class="fu">unique</span>(covid_df<span class="sc">$</span>Country.Region))</span></code></pre></div>
<p><code>Warning in countrycode_convert(sourcevar = sourcevar, origin = origin, destination = dest,  :</code>
<code>Some values were not matched unambiguously: Diamond Princess, Micronesia, MS Zaandam, Summer Olympics 2020, Winter Olympics 2022</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove Summer Olympics 2020 &amp; Winter Olympics 2022,Micronesia</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>covid_remove <span class="ot">&lt;-</span> covid_df[<span class="sc">-</span><span class="fu">which</span>(covid_df<span class="sc">$</span>Country.Region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Summer Olympics 2020&quot;</span>, <span class="st">&quot;Winter Olympics 2022&quot;</span>, <span class="st">&quot;Micronesia&quot;</span>)),]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Diamond Princess - Japan</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>covid_remove<span class="sc">$</span>Country.Region[covid_remove<span class="sc">$</span>Country.Region <span class="sc">==</span> <span class="st">&quot;Diamond Princess&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Japan&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#MS Zaandam - Netherlands</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>covid_remove<span class="sc">$</span>Country.Region[covid_remove<span class="sc">$</span>Country.Region <span class="sc">==</span> <span class="st">&quot;MS Zaandam&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Netherlands&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># adding a column called &quot;countryname&quot; to be the standard country names, and when mismatch then the country must be one of our adjusted countries, so just keep it as it is.</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>covid_match <span class="ot">&lt;-</span> covid_remove <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country.name =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="fu">countryname</span>(covid_remove<span class="sc">$</span>Country.Region)),covid_remove<span class="sc">$</span>Country.Region,<span class="fu">countryname</span>(covid_remove<span class="sc">$</span>Country.Region)))</span></code></pre></div>
</div>
<div id="gdp" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> GDP<a href="#gdp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>GDP_temp <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/world_bank_gdp.csv&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>GDP <span class="ot">&lt;-</span> GDP_temp[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Howard-HaoChang/Disaster_analysis/edit/main/%s",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Howard-HaoChang/Disaster_analysis/blob/main/%s",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
